<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="title" content="Ask online Form">
    <meta name="description" content="The Ask is a bootstrap design help desk, support forum website template coded and designed with bootstrap Design, Bootstrap, HTML5 and CSS. Ask ideal for wiki sites, knowledge base sites, support forum sites">
    <meta name="keywords" content="HTML, CSS, JavaScript,Bootstrap,js,Forum,webstagram ,webdesign ,website ,web ,webdesigner ,webdevelopment">
    <meta name="robots" content="index, nofollow">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="language" content="English">
    <link href="css/bootstrap.css" rel="stylesheet" type="text/css">
    <link href="css/style.css" rel="stylesheet" type="text/css">
    <link href="css/editor.css" rel="stylesheet" type="text/css">
    <!-- <link href="css/animate.css" rel="stylesheet" type="text/css"> -->
    <link href="css/font-awesome.min.css" rel="stylesheet" type="text/css"> </head>
    <link href="css/responsive.css" rel="stylesheet" type="text/css"> </head>

   
<body style="background-color: #78421228;">
    <div class="container-top">
        <div class="navbar-top">
          
          <nav>
            <ul>
            <li class="dropdown-top">
                <a href="../index.html" class="nav_text_big">首页</a>
            </li>
            <li class="dropdown-top">
                <a href="../basis/index.html" class="nav_text_big">古观山海</a>
            </li>
            <li class="dropdown-top">
                <a href="../html/起源.html" class="nav_text_big">云游山海</a>
            </li>
            <li>
              <a href="./category.html" class="nav_text_big">山海论坛</a>
            </li>
            <li>
              <a href="../lvyou/lvyou.html" class="nav_text_big">山海足迹</a>
            </li>

            </ul>
          </nav>
          <a href="../xsy/logIn.html">
            <img src="../img/登录.png" class="menu-icon-top shopcar"/>
          </a> 
          <a href="../xsy/logIn.html">
              <img src="../img/_购物车.png" class="menu-icon-top shopcar"/>
          </a> 

        </div>
      </div>
    
    <script>
        window.onload = function() {
            alert('您可以先点击下方的"获取地址"按钮获取当前位置信息！')
        }
    </script>
    <section class="header-descriptin329">
        <div class="container">
            <h3>上传作品</h3>
            <ol class="breadcrumb breadcrumb839">
                <li><a href="#">主页</a></li>
                <li class="active">上传作品</li>
            </ol>
        </div>
    </section>
    <section class="main-content920">
        <div class="container">
            <div class="row">
                <div class="col-md-9">
                <div class="ask-question-input-part032">
                      <h4>作品信息</h4>
                 <hr>
                    <form>
                        <div class="username-part940">
                            <span class="form-description43">作品id* </span><input type="text" name="fname" class="username029" id="enterid" placeholder="请输入作品编号（随意填写，可以重复）">  
     </div>
                    <div class="username-part940">
                        <span class="form-description43">作者id* </span><input type="text" name="fname" class="username029" id="enterauthor" placeholder="输入作者编号">  
 </div>
 <div class="categori49">
    <span class="form-description43305">主题* </span>
    <label>
<input list="categories" id="entertopic" name="mymeaning" placeholder="请选择作品的主题" class="list-category53"/></label>
<datalist id="categories">
    <option value="神祗">
    <option value="神兽">
    <option value="山">
    <option value="植物">
    <option value="其他">
  </datalist>  
</div>


<!-- <div class="question-title39">
    <span class="form-description433">非遗种* </span><input type="text" name="fname" class="question-ttile32" id="entercate" placeholder="Write Your Question Title">
</div> -->
    
<!-- <div class="categori49">
    <span class="form-description433056">非遗种*</span>
    <label>
<input list="feiyicate" id="entercate" name="myfeiyi"  placeholder="请选择" class="list-category53"/></label>
<datalist id="feiyicate">
    <option value="湘西苗绣">
    <option value="雷山苗绣">
    <option value="松桃苗绣">
    <option value="剑河苗绣">
  </datalist>  
</div> -->


    <!-- <div class="categori49">
        <span class="form-description43305">类别* </span>
        <label>
<input list="browsers" id="entercatenum" placeholder="请选择" name="myBrowser" class="list-category53"/></label>
<datalist id="browsers">
    <option value="1">
    <option value="2">
    <option value="3">
    </datalist>
  </div> -->

<!-- 添加一个空白行 -->
<div style="margin-bottom: 35px;"></div>
<div class="username-part940">
    <span class="form-description433111">名字* </span><input type="text" name="fname" class="username029" id="entername" placeholder="输入作品名称">  
</div>

  <div class="username-part940">
    <span class="form-description433111">寓意* </span><input type="text" name="fname" class="username029" id="entermeaning" placeholder="输入作品寓意">  
</div>
    <div class="button-group-addfile3239">
        <span class="form-description23993">图片*</span><input type="file" name="ffile" class="question-ttile3226" id='upload' onchange="getFile(value)">  
    </div>

    <script>
     function getFile(value){
        // 获取上传控件dom
        var picname = document.getElementById('upload').files[0].name;
        // 获取文件路径
        console.log(name);
    }
    </script>


<!-- <span class="form-description23993">描述</span>
       <div class="details2-239">
        <div class="col-md-12 nopadding">
            <textarea id="txtEditor"></textarea> 
        </div>
        </div>	 -->

        <div class="username-part940">
            <span class="form-description433">描述 </span><input type="text" name="fname" class="username029" id="txtEditor" placeholder="作品描述">  
</div>
<div class="username-part940">
    <span class="form-description433111">纬度* </span><input type="text" name="latitudename" class="username029" id="enterlatitude" placeholder="点击下方，自动识别当前纬度">  
</div>
<div class="username-part940">
    <span class="form-description433111">经度* </span><input type="text" name="latitudename" class="username029" id="enterlongtitude" placeholder="点击下方，自动识别当前经度">  
</div>
<div class="username-part940">
    <span class="form-description433112">行政编码* </span><input type="text" name="latitudename" class="username029" id="enteradcode" placeholder="点击下方，自动识别当前行政编码">  
</div>
<div class="username-part940">
    <span class="form-description433111">地区* </span><input type="text" name="latitudename" class="username029" id="enterdistrict" placeholder="点击下方，自动识别当前地区">  
</div>
<div class="username-part940">
    <span class="form-description433111">价格* </span><input type="text" name="price" class="username029" id="enterprice" placeholder="请输入作品的定价">  
</div>
</form>
<div class="publish-button2389">
    <button type="button" id="redirect" class="publis1291" onclick="redirectToNewPage()">获取地址</button>
</div>


                 <div class="publish-button2389">
                    <button type="button" id="puttodb" onclick="alert('作品上传成功，感谢您的参与！')" class="publis1291" >上传作品</button>
                </div>


               
                </div>
             
              
                </div>
<!--                end of col-md-9 -->
           
<!--           strart col-md-3 (side bar)-->
           <aside class="col-md-3 sidebar97239">
             <div class="status-part3821">
            <h4>山海社区</h4>
                
                 <a href="./shangchuanzuopin.html"><i class="fa fa-question-circle" aria-hidden="true"> 上传作品</i></a>
                 <a href="./category.html"><i class="fa fa-question-circle" aria-hidden="true"> 山海论坛</i></a>
             </div>  
             <div class="categori-part329">
                 <h4>云游山海</h4>
                 <ul>
                    <li><a href="../basis/index.html">《中山经》之山海经</a></li>
                    <li><a href="../html/异兽.html">《山海经》异兽图谱</a></li>
                    <li><a href="../html/植物.html">《山海经》植物图鉴</a></li>
                    <li><a href="../html/神祇.html">《山海经》神祗故事</a></li>
                    <li><a href="../html/起源.html">《山海经》起源地图</a></li>
                     
                 </ul>
             </div>

             <div class="social-part2189">
                <h4>最新作品</h4>
                <ul id="item-list"></ul>
              </div>

              <script>
                // Function to load and display items from the JSON file
                async function loadItems() {
                  try {
                    const response = await fetch('erchuangzuopin.json'); // Fetch the JSON file
                    const items = await response.json(); // Parse the JSON
              
                    // Get the item list element
                    const itemList = document.getElementById('item-list');
              
                    // Reverse the items array to display from last to first and take the first 4 items
                    const latestItems = items.slice().reverse().slice(0, 4);
              
                    // Loop through the items and create the list elements
                    latestItems.forEach(item => {
                      // Create a list item element
                      const listItem = document.createElement('li');
                      listItem.className = 'rss-one';
                      listItem.setAttribute('onclick', `go_to_item(${item.id}, 0)`);
              
                      // Create a strong element to hold the item details
                      const strong = document.createElement('strong');
              
                      // Create a span element for the item name
                      const span = document.createElement('span');
                      span.textContent = item.作品名称;
              
                      // Create a small element for the description
                      const small = document.createElement('small');
                      small.textContent = `寓意："${item.寓意}"，发布者ID：${item.发布者ID}`;
              
                      // Append the span and small elements to the strong element
                      strong.appendChild(span);
                      strong.appendChild(document.createElement('br'));
                      strong.appendChild(small);
              
                      // Append the strong element to the list item
                      listItem.appendChild(strong);
              
                      // Append the list item to the item list
                      itemList.appendChild(listItem);
                    });
                  } catch (error) {
                    console.error('Error loading items:', error);
                  }
                }
              
                // Call the function to load items when the page loads
                document.addEventListener('DOMContentLoaded', loadItems);
              </script>
                
 <!--              login part-->
 <div class="login-part2389">
    <h4>登录</h4>
    <div class="input-group300">
    <span><i class="fa fa-user" aria-hidden="true"></i></span>
    <input type="text" class="namein309" placeholder="输入用户名">
    </div>
        <div class="input-group300">
    <span><i class="fa fa-lock" aria-hidden="true"></i></span>
    <input type="password" class="passin309" placeholder="输入密码">
    </div>
    <a href="../index.html"><button type="button" class="userlogin320">登录</button></a>
    <div class="rememberme">
                  <label><input type="checkbox" checked="checked"> 记住我</label>
                  <a href="#" class="resbutton3892">注册</a>
              </div>
</div>
          
           </aside>
            </div>

        </div>
    </section>
    
<!--    footer -->
   <div class="footer-search">
     <div class="container">
	<div class="row">
           <div id="custom-search-input">
                            <div class="input-group col-md-12">
                               <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                                <input type="text" class="  search-query form-control user-control30" placeholder="在这里搜索...." />
                                <span class="input-group-btn">
                                    <button class="btn btn-danger" type="button">
                                        <span class=" glyphicon glyphicon-search"></span>
                                    </button>
                                </span>
                            </div>
                        </div>
	</div>
</div>
   </div>
    
   <section class="footer-part">
    <div class="container">
        <div class="row">
            
            <div class="col-md-3">
              <div class="info-part-one320">
               <h4>基本信息</h4>
                <p>武汉大学遥感信息工程学院《GIS工程设计与开发实习》第十五组</p>
                <h4>地址 :</h4>
                <p>湖北省武汉市珞喻路129号武汉大学信息学部 教学实验大楼3楼、6楼—9楼,五号教学楼,宇航科学与技术研究院</p>
                <h4>联系方式</h4>
                <p>电话号码: 18986197481</p>
                <p>邮箱账号 : </p>
                <p>2021302191847@whu.edu.cn</p>
                </div>
            </div>
               <div class="col-md-3">
              <div class="info-part-two320">
          <h4>快速链接</h4>
               <a href="../index.html"><p>-主页</p></a>
                 <a href="../basis/index.html"><p>-古观山海</p></a>
                 <a href="../html/起源.html"><p>-云游山海</p></a>
                 <a href="../xsy/category.html"><p>-山海社区</p></a>
                 <a href="../lvyou/lvyou.html"><p>-山海足迹</p></a>
                 <a href="../xsy/logIn.html"><p>-登录</p></a>
                 <a href="../html/起源.html"><p>-山海起源</p></a>
                </div>
            </div>
               <div class="col-md-3">
              <div class="info-part-three320">
               <h4>人气作品</h4>
              <div class="news-info209">
              
               <h5>高山君（“神祇"）</h5>
                <p>高山君，一幅描绘山岳之灵的画作。画中的形象雄伟而神秘...</p> 
                <small>2017-7-16</small>
                  </div>
                   <div class="news-info209">
            <h5>老满（“神兽”）</h5>
                <p>老满，是一幅描绘智慧老人的画作。画中老者满面皱纹，却透 ...</p>
                <small>2019-7-9</small>
                  </div>
                    <div class="news-info209">
            <h5>八哥（“神祇”）</h5>
                <p>八哥，一幅生动描绘鸟类形象的画作。画中的八哥羽毛鲜亮，眼神灵动，嘴巴弯曲，...</p>
                <small>2023-12-29</small>
                  </div>
                
                </div>
            </div>
               <div class="col-md-3">
              <div class="info-part-four320">
               <h4>山海论坛</h4>
               <div class="tweet-details29">
                <h5>二创作品上传</h5>
                <p><i class="fa fa-twitter-square" aria-hidden="true"></i><a href="./shangchuanzuopin.html">每幅作品都是创造力的体现，都是作者对传统文化的深深敬仰 ...</a></p>
               
                  </div>
                        <div class="tweet-details29">
                <h5>山海初印象</h5>
                <p><i class="fa fa-twitter-square" aria-hidden="true"></i><a href="./question_1.html">《山海经》中记载了大量中国古代神话的源头, ...</a></p>
              
                  </div>
                        <div class="tweet-details29">
                <h5>神奇山海故事</h5>
                <p><i class="fa fa-twitter-square" aria-hidden="true"></i><a href="./question_2.html">《山海经》就像一座博物馆,收藏着中国古代最神奇、最瑰丽的文化瑰宝...</a></p>
                 
                  </div>
                  <div class="tweet-details29">
                    <h5>山海奥秘</h5>
                    <p><i class="fa fa-twitter-square" aria-hidden="true"></i><a href="./question_3.html">《山海经》确实是一部晦涩难懂的奇书。它时空跳跃性极强,...</a></p>
                   
                      </div>
                  <div class="tweet-details29">
                  <h5>山海创新</h5>
                  <p><i class="fa fa-twitter-square" aria-hidden="true"></i><a href="./question_4.html">UP主“山栀_”的《山海异志》系列。 该系列以动画的形式还原了...</a></p>
                 
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<section class="footer-social">
<div class="container">
    <div class="row">
        <div class="col-md-6">
            <p>Copyright 2023 山海经 | <strong>《GIS工程设计与开发实习》第十五组</strong></p>
        </div>
         <div class="col-md-6">
          <div class="social-right2389">
           <a href="#"><i class="fa fa-twitter-square" aria-hidden="true"></i></a>
           <a href="#"><i class="fa fa-facebook" aria-hidden="true"></i></a>
           <a href="#"><i class="fa fa-google-plus" aria-hidden="true"></i></a>
           <a href="#"><i class="fa fa-youtube" aria-hidden="true"></i></a>
           <a href="#"><i class="fa fa-skype" aria-hidden="true"></i></a>
           <a href="#"><i class="fa fa-linkedin" aria-hidden="true"></i></a>
           <a href="#"><i class="fa fa-rss" aria-hidden="true"></i></a>
             </div>
        </div>
    </div>
</div>
</section>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="js/jquery-3.1.1.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script type="text/javascript" src="./js/getUrlParam.js"></script> 
  <!-- <script src="js/editor.js"></script>
   <script>
        $(document).ready(function() {
            $("#txtEditor").Editor();
        });
    </script> -->
    <script>
        function redirectToNewPage() {
            // 使用 window.location.href 修改页面 URL
            window.location.href = "8.html";
        }
    </script>
    <!-- <script type="text/javascript" src="./js/getUrlParam.js"></script> -->
     <script> 
     if(UrlParam.paramValues("latitude")>0)
    {
    var latitude1 = UrlParam.paramValues("latitude"); 
    var longtitude1 = UrlParam.paramValues("longtitude"); 
    var district1= UrlParam.paramValues("district");
    var adcode1= UrlParam.paramValues("adcode");
    console.log(latitude1); 
    console.log(longtitude1); 
    console.log(district1); 
    
        document.getElementById("enteradcode").value = adcode1;
        document.getElementById("enterlatitude").value = latitude1;
        document.getElementById("enterlongtitude").value = longtitude1;
        document.getElementById("enterdistrict").value = district1;
    }
    </script> 
 


<script type="text/javascript">   
// 检查所有单元格是否全部填完整的函数
function checkCompleteness() {
    // 通过逐一检查每个输入框是否为空来判断是否填写完整
    var inputs = ["#enterid", "#enterauthor", "#entertopic", "#entercate", "#entercatenum", "#entermeaning", "#entername", "#upload", "#enteradcode", "#enterdistrict", "#enterlongtitude", "#enterlatitude"];
    for (var i = 0; i < inputs.length; i++) {
        if ($(inputs[i]).val() === "") {
            return false; // 如果有任何一个输入框为空，返回 false
        }
    }
    return true; // 所有输入框都填写完整，返回 true
}




var my_switch = true;
$(document).ready(function () {
    // 发起对服务器端 /checkConnection 端点的请求
    $.ajax({
        url: 'http://localhost:5500/checkConnection',  // 请替换为你的服务器地址
        type: 'GET',
        dataType: 'json',
        success: function (response) {
            // 根据返回结果设置前端变量
            var my_switch = response.mySwitch;

            // 在这里使用 my_switch，执行你的逻辑
            my_switch=true;
            if (my_switch) {
                console.log('Database connected!');
                $("#puttodb").click(function () {
                     // 检查所有单元格是否全部填完整
    // if (!checkCompleteness()) {
    //     // 如果有未填完整的单元格，弹出提示框
    //     alert("请填写完整");
    //     return; // 阻止执行后续的代码
    // }

    var id = $("#enterid").val();
    var author = $("#enterauthor").val();
    var topic = $("#entertopic").val();
    var category = $("#entercate").val();
    var categorynum = $("#entercatenum").val();
    var meaning = $("#entermeaning").val();
    var name = $("#entername").val();
    var description = $("#txtEditor").val();
    var picturePath = $("#upload").val();
    var picture = picturePath.split(/[\\\/]/).pop();
    var adcode=$("#enteradcode").val();
    const ename=$("#enterdistrict").val();
    const longtitude=$("#enterlongtitude").val();
    const latitude=$("#enterlatitude").val();
    const price=$("#enterprice").val();
    const ups=0;
    const soldnum=0;
$.ajax({
            url: 'http://localhost:5500/addtodb',
            type: 'get',
            dataType: 'json',
            data: {
                id:id, author: author, name:name,picture:picture,topic:topic,category:category,description:description,meaning:meaning,longtitude:longtitude,latitude:latitude, adcode:adcode,ename:ename,price:price, ups:ups, soldnum:soldnum
            }, // Pass the parameter here
            success: function (data) {
              console.log(data);
            }
        });
       // 构建要写入文件的数据对象
       var newData = {
            id:id, author: author, name:name,picture:picture,topic:topic,category:category,description:description,meaning:meaning,longtitude:longtitude,latitude:latitude, adcode:adcode,ename:ename,price:price, ups:ups, soldnum:soldnum
          };

        $.ajax({
            url: 'http://localhost:5500/saveData',
            type: 'post',
            contentType: 'application/json',
            data: JSON.stringify(newData),
            success: function (response) {
                // 上传成功后刷新页面
    location.reload();
                console.log(response);
            }
        });
    });
            }

      },
        error: function () {
            console.log('Database not connected!');
                $("#puttodb").click(function () {
                    var id = $("#enterid").val();
    var author = $("#enterauthor").val();
    var topic = $("#entertopic").val();
    var category = $("#entercate").val();
    var categorynum = $("#entercatenum").val();
    var meaning = $("#entermeaning").val();
    var name = $("#entername").val();
    var description = $("#txtEditor").val();
    var picturePath = $("#upload").val();
    var picture = picturePath.split(/[\\\/]/).pop();
    var adcode=$("#enteradcode").val();
    const ename=$("#enterdistrict").val();
    const longtitude=$("#enterlongtitude").val();
    const latitude=$("#enterlatitude").val();
    const price=$("#enterprice").val();
    const ups=0;
    const soldnum=0;
        // 构建要写入文件的数据对象
        var newData = {
            id:id, author: author, name:name,picture:picture,topic:topic,category:category,description:description,meaning:meaning,longtitude:longtitude,latitude:latitude, adcode:adcode,ename:ename,price:price, ups:ups, soldnum:soldnum
        
        };

        $.ajax({
            url: 'http://localhost:5500/saveData',
            type: 'post',
            contentType: 'application/json',
            data: JSON.stringify(newData),
            success: function (response) {
                console.log(response);
                // 上传成功后刷新页面
    location.reload();
            }
        });
    });
        }
    });
});

function go_to_item(item_id,is_class){
    localStorage.setItem('item_id', item_id);
    localStorage.setItem('item_type', is_class);
    window.location.href = '../html/product.html';
}



</script>
    
  





  
</body>

</html>